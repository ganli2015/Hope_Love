#pragma once
#include "InOut.h"

#define _CRTDBG_MAP_ALLOC  
#include <stdlib.h>  
#include <crtdbg.h>  


namespace CommonTool
{
	class _COMMONTOOLSINOUT MemoryDetector
	{
		_CrtMemState _s1;
		_CrtMemState _s2;

	public:
		MemoryDetector();
		~MemoryDetector();

		//////////////////////////////////////////////////////////////////////////
		///Record current memory status.
		//////////////////////////////////////////////////////////////////////////
		void Snapshot();

		//////////////////////////////////////////////////////////////////////////
		///If the latest two snapshot are different, return false.
		//////////////////////////////////////////////////////////////////////////
		bool UnchangedSnapshot() const;

		//////////////////////////////////////////////////////////////////////////
		///Get a string that describes difference between the previous two memory checks.
		//////////////////////////////////////////////////////////////////////////
		string PrintDiff() const;

		//////////////////////////////////////////////////////////////////////////
		///Output latest check.
		//////////////////////////////////////////////////////////////////////////
		void OutputLatestStat() const;
	};
}


